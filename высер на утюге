#include <SFML/Graphics.hpp>
#include <iostream>
#include <string>

using namespace std;
using namespace sf;

int main()
{
    // Создание окна
    RenderWindow window(VideoMode(600, 400), "Clicker Game");

    // Создание текста для отображения счета
    Font font;
    if (!font.loadFromFile("arial.ttf")) {
        cerr << "Unable to load font file!" << endl;
        return 1;
    }

    Texture texture;
    if (!texture.loadFromFile("C:/Users/isp924/Desktop/Picforgame/cave.png")) {
        return 2; // В случае ошибки загрузки фона
    }
    Sprite background(texture);  // Создание спрайта с фоном
    background.setScale(0.3f, 0.3f);

    Texture mob1Texture;
    if (!mob1Texture.loadFromFile("C:/Users/isp924/Desktop/Picforgame/whitemonsrt.png")) {
        return 3; // В случае ошибки загрузки кнопки
    }
    Sprite button(mob1Texture);  //Создание спрайта моба
    button.setPosition(530 - button.getGlobalBounds().width / 2, 350 - button.getGlobalBounds().height / 2);
    button.setScale(0.5f, 0.5f); // Уменьшение размера кнопки вдвое по горизонтали и вертикали

    Texture increasedmg;
    if (!increasedmg.loadFromFile("C:/Users/isp924/Desktop/Picforgame/upgtab.png")) {
        return 4; // В случае ошибки загрузки кнопки
    }
    Sprite butincdmg(increasedmg);  //Создание спрайта моба
    butincdmg.setPosition(397 - butincdmg.getGlobalBounds().width / 2, 400 - butincdmg.getGlobalBounds().height / 2);
    butincdmg.setScale(0.2f, 0.2f);

    // Инициализация счетчика
    int score = 0;
    Text scoreText;
    scoreText.setFont(font);
    scoreText.setCharacterSize(24);
    scoreText.setFillColor(Color::White);
    scoreText.setPosition(10, 10);

    //Инициализация полоски здоровья
    int hp = 1000;
    Text hpText;
    hpText.setFont(font);
    hpText.setCharacterSize(24);
    hpText.setFillColor(Color::White);
    hpText.setPosition(400, 95);

    //Инициализация урона
    int dmg = 1;
    Text dmgText;
    dmgText.setFont(font);
    dmgText.setCharacterSize(24);
    dmgText.setFillColor(Color::White);
    dmgText.setPosition(100, 300);

    

    // Основной цикл программы
    while (window.isOpen())
    {
        // Обработка событий
        Event event;
        while (window.pollEvent(event))
        {
            // Обработка события клика мыши
            if (event.type == Event::MouseButtonPressed)
            {
                if (event.mouseButton.button == Mouse::Left)
                {
                    // Проверка, был ли клик внутри кнопки
                    if (button.getGlobalBounds().contains(event.mouseButton.x, event.mouseButton.y))
                    {
                        // Увеличение счетчика при клике на кнопку
                        score++;
                        hp -= dmg;
                    }
                    if (butincdmg.getGlobalBounds().contains(event.mouseButton.x, event.mouseButton.y))
                    {
                        // Увеличение переменной dmg на 1 при клике на кнопку
                        dmg++;
                        score--;
                        if (score < 0) {
                            char attext;
                            Text attextText;
                            attextText.setFont(font);
                            attextText.setCharacterSize(14);
                            attextText.setFillColor(Color::White);
                            attextText.setPosition(100, 100);
                            if (attextText.getElapsedTime().asSeconds() >= 2) {
                                break;
                            }
                        }
                    }
                }
            }
        }

        // Обновление текста счета
        scoreText.setString("Coins: " + to_string(score));
        //Обновление полоски здоровья
        hpText.setString("HP: " + to_string(hp));
        //Обновление урона
        dmgText.setString("DMG: " + to_string(dmg));
        //Обновление уведомления
        attextText.setString("Not enogth money");

        // Очистка экрана
        window.clear();

        // Отрисовка фона
        window.draw(background);

        //Отрисовка моба
        window.draw(button);
        window.draw(butincdmg);

        // Отрисовка текста
        window.draw(scoreText);
        window.draw(hpText);
        window.draw(dmgText);
        window.draw(attextText);

        // Отображение изменений на экране
        window.display();
    }

    return 0;
}
